import{w as S}from"./with-props-W20A4A-s.js";import{r as t,l as e,L as P}from"./chunk-K6CSEXPM--6-6YwCy.js";import{A as E}from"./AuthContext-ChgrtSKK.js";import{P as y}from"./ProtectedRoute-WFYVxz1c.js";import{C as L}from"./circle-alert-ieDbjemo.js";import{C as M}from"./circle-check-big-TdVgapQe.js";import{U as d}from"./user-CNUf_l29.js";import{c as A}from"./createLucideIcon-DiAdES6P.js";import{M as F}from"./mail-Dab9SNH2.js";import{C as T}from"./calendar-BN6mDgRF.js";import{S as $}from"./save-Cfpy_75o.js";import{X as I}from"./x-DjrKpXYw.js";/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],z=A("PenLine",U),Z=S(function(){const{user:q,token:i}=t.useContext(E),[s,g]=t.useState(null),[c,m]=t.useState(!1),[N,v]=t.useState(!0),[x,f]=t.useState(!1),[j,r]=t.useState(null),[b,h]=t.useState(null),[o,u]=t.useState({first_name:"",last_name:"",email:""});t.useEffect(()=>{(async()=>{if(i)try{const a=await fetch("https://eventqr.app/api/auth/me/",{headers:{Authorization:`Token ${i}`,"Content-Type":"application/json"}});if(a.ok){const l=await a.json();g(l),u({first_name:l.first_name||"",last_name:l.last_name||"",email:l.email||""})}else r("Failed to load profile")}catch{r("Network error: Could not load profile")}finally{v(!1)}})()},[i]);const w=()=>{m(!0),r(null),h(null)},C=()=>{m(!1),u({first_name:(s==null?void 0:s.first_name)||"",last_name:(s==null?void 0:s.last_name)||"",email:(s==null?void 0:s.email)||""}),r(null)},_=async()=>{if(!(!i||!s)){f(!0),r(null);try{const n=await fetch("https://eventqr.app/api/auth/me/",{method:"PATCH",headers:{Authorization:`Token ${i}`,"Content-Type":"application/json"},body:JSON.stringify(o)});if(n.ok){const a=await n.json();g(a),m(!1),h("Profile updated successfully!"),setTimeout(()=>h(null),3e3)}else{const a=await n.json();r(a.detail||"Failed to update profile")}}catch{r("Network error: Could not update profile")}finally{f(!1)}}},p=n=>{const{name:a,value:l}=n.target;u(k=>({...k,[a]:l}))};return N?e.jsx(y,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-gray-600",children:"Loading profile..."})]})})})}):e.jsx(y,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:e.jsxs("div",{className:"max-w-4xl mx-auto pt-20 pb-8 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("nav",{className:"flex items-center space-x-2 text-sm text-gray-500 mb-4",children:[e.jsx(P,{to:"/",className:"hover:text-gray-700",children:"Home"}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"text-gray-900 font-medium",children:"Profile"})]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Your Profile"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage your account information and preferences"})]}),j&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 text-red-700 rounded-lg flex items-start gap-3",children:[e.jsx(L,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:j})]}),b&&e.jsxs("div",{className:"mb-6 p-4 bg-green-50 text-green-700 rounded-lg flex items-start gap-3",children:[e.jsx(M,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:b})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 px-6 py-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 h-20 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:e.jsx(d,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{className:"text-white",children:[e.jsx("h2",{className:"text-2xl font-bold",children:s!=null&&s.first_name&&(s!=null&&s.last_name)?`${s.first_name} ${s.last_name}`:(s==null?void 0:s.username)||"User"}),e.jsxs("p",{className:"text-blue-100",children:["@",s==null?void 0:s.username]})]})]}),!c&&e.jsxs("button",{onClick:w,className:"flex items-center space-x-2 px-4 py-2 bg-white bg-opacity-20 text-gray-800 rounded-lg hover:bg-opacity-30 transition-colors",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{children:"Edit Profile"})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),c?e.jsx("input",{type:"text",name:"first_name",value:o.first_name,onChange:p,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your first name"}):e.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[e.jsx(d,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:(s==null?void 0:s.first_name)||"Not set"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),c?e.jsx("input",{type:"text",name:"last_name",value:o.last_name,onChange:p,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your last name"}):e.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[e.jsx(d,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:(s==null?void 0:s.last_name)||"Not set"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),c?e.jsx("input",{type:"email",name:"email",value:o.email,onChange:p,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your email"}):e.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[e.jsx(F,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:s==null?void 0:s.email})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),e.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[e.jsx(d,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:s==null?void 0:s.username}),e.jsx("span",{className:"text-xs text-gray-500",children:"(cannot be changed)"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Member Since"}),e.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[e.jsx(T,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:s!=null&&s.date_joined?new Date(s.date_joined).toLocaleDateString():"N/A"})]})]})]}),c&&e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:_,disabled:x,className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:"Save Changes"})]})}),e.jsxs("button",{onClick:C,disabled:x,className:"flex items-center space-x-2 px-6 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:"Cancel"})]})]})})]})]})]})})})});export{Z as default};
