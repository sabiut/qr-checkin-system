const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/client-37Ouhr38.js","assets/chunk-K6CSEXPM--6-6YwCy.js"])))=>i.map(i=>d[i]);
import{w as ie}from"./with-props-W20A4A-s.js";import{r as l,l as e,v as le,n as oe,L as A}from"./chunk-K6CSEXPM--6-6YwCy.js";import{A as ce}from"./AuthContext-ChgrtSKK.js";import{L as P}from"./loader-circle-DsNQqkuh.js";import{E as de,D as me}from"./eye-B1-8Y-gW.js";import{c as _}from"./createLucideIcon-DiAdES6P.js";import{S as xe}from"./send-Wy_W9YVp.js";import{C as T}from"./circle-alert-ieDbjemo.js";import{C as R}from"./chevron-left-CrOaInnJ.js";import{C as he}from"./calendar-BN6mDgRF.js";import{C as pe}from"./clock-9uqc5bvb.js";import{M as ue}from"./map-pin-Ci7QSU5N.js";import{U as B}from"./users-Q26tldAh.js";import{V as ge}from"./video-CxMMTtW4.js";import{U as fe}from"./user-check-DO35yh_q.js";import{M as D}from"./mail-Dab9SNH2.js";import{T as Y}from"./trash-2-DM6o8tQ3.js";import{P as G}from"./phone-Bl7fnqbU.js";import{C as K}from"./check-CbxJQtMf.js";import{Q as ye}from"./qr-code-1vz7lEYt.js";import{X as je}from"./x-DjrKpXYw.js";/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],be=_("CirclePlus",ve);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],we=_("CircleX",Ne);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],_e=_("ClipboardList",ke);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ee=_("Copy",Ce);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],$e=_("ExternalLink",Se);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Te=_("FileText",ze);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Ie=_("Printer",Le);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],De=_("Ticket",Ae),Pe="modulepreload",qe=function(n){return"/"+n},ee={},Me=function(i,g,h){let w=Promise.resolve();if(g&&g.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),m=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));w=Promise.allSettled(g.map(x=>{if(x=qe(x),x in ee)return;ee[x]=!0;const j=x.endsWith(".css"),C=j?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${C}`))return;const p=document.createElement("link");if(p.rel=j?"stylesheet":Pe,j||(p.as="script"),p.crossOrigin="",p.href=x,m&&p.setAttribute("nonce",m),document.head.appendChild(p),j)return new Promise(($,k)=>{p.addEventListener("load",$),p.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${x}`)))})}))}function t(o){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=o,window.dispatchEvent(m),!m.defaultPrevented)throw o}return w.then(o=>{for(const m of o||[])m.status==="rejected"&&t(m.reason);return i().catch(t)})},Fe=({invitation:n,onSendEmail:i})=>{var E;const[g,h]=l.useState("html"),[w,t]=l.useState(!1),[o,m]=l.useState(null),[x,j]=l.useState(!1),[C,p]=l.useState(null);l.useEffect(()=>{g==="html"&&$()},[n.id,g]);const $=async()=>{var d;try{j(!0),p(null);const S="https://eventqr.app";let v=n.qr_code_url;v&&v.startsWith("/")&&(v=`${S}${v}`);const L=`
        <html>
        <head>
          <style>
            body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
            .ticket { max-width: 500px; margin: 0 auto; border: 2px solid #4f46e5; border-radius: 8px; overflow: hidden; }
            .header { background: #4f46e5; color: white; padding: 15px; text-align: center; }
            .body { padding: 20px; }
            .footer { background: #f3f4f6; padding: 10px; text-align: center; font-size: 0.8em; }
            .section { margin-bottom: 20px; }
            .property { margin-bottom: 8px; }
            .label { font-weight: bold; }
          </style>
        </head>
        <body>
          <div class="ticket">
            <div class="header">
              <h2>${((d=n.event)==null?void 0:d.name)||"Event Ticket"}</h2>
              <h3>For ${n.guest_name}</h3>
            </div>
            <div class="body">
              <div class="section">
                <h3>Guest Information</h3>
                <div class="property">
                  <span class="label">Name:</span> ${n.guest_name}
                </div>
                ${n.guest_email?`
                <div class="property">
                  <span class="label">Email:</span> ${n.guest_email}
                </div>`:""}
                ${n.guest_phone?`
                <div class="property">
                  <span class="label">Phone:</span> ${n.guest_phone}
                </div>`:""}
              </div>

              <div class="section">
                <h3>Event Details</h3>
                ${n.event?`
                <div class="property">
                  <span class="label">Date:</span> ${n.event.date||"TBD"}
                </div>
                <div class="property">
                  <span class="label">Time:</span> ${n.event.time||"TBD"}
                </div>
                <div class="property">
                  <span class="label">Location:</span> ${n.event.location||"TBD"}
                </div>`:`
                <p style="font-style: italic; color: #666;">Event details will be provided by the organizer.</p>
                `}
              </div>
              
              ${v?`
              <div class="section" style="text-align: center;">
                <h3>QR Code for Check-in</h3>
                <img src="${v}" alt="QR Code" style="max-width: 200px; height: auto;">
                <p>Present this code at the event entrance</p>
              </div>`:""}
              
              <div style="font-size: 0.8em; text-align: right; color: #666;">
                Ticket ID: ${n.id}
              </div>
            </div>
            <div class="footer">
              <p>This ticket is personalized and non-transferrable.</p>
              <p>Generated by QR Check-in System</p>
            </div>
          </div>
        </body>
        </html>
      `;try{const z=await fetch(`https://eventqr.app/tickets/${n.id}/`);if(z.ok){const U=await z.text();m(U)}else console.warn("Could not fetch ticket from backend, using local version"),m(L)}catch(I){console.error("Error fetching ticket:",I),m(L)}}catch(S){console.error("Error in ticket handling:",S),p("Could not load the ticket. Please try again later.")}finally{j(!1)}},k=()=>{if(!o)return;const d=window.open("","_blank");d&&(d.document.write(o),d.document.close(),d.onload=()=>{d.print()})},q=async()=>{if(!(!i||!n.guest_email)){t(!0);try{await i(),alert("Email sent successfully!")}catch(d){console.error("Error sending email:",d),alert("Failed to send email. Please try again.")}finally{t(!1)}}},H=()=>{if(!o)return"#";const d=new Blob([o],{type:"text/html"});return URL.createObjectURL(d)};return e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"border-b px-4 py-3 bg-gray-50 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-700",children:["Ticket for ",n.guest_name]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>h("html"),className:`px-3 py-1 text-sm rounded ${g==="html"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Full Ticket"}),e.jsx("button",{onClick:()=>h("qr"),className:`px-3 py-1 text-sm rounded ${g==="qr"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"QR Only"})]})]}),e.jsx("div",{className:"p-4",children:g==="html"?e.jsx("div",{className:"aspect-[3/4] border rounded overflow-hidden bg-gray-50",children:x?e.jsxs("div",{className:"h-full flex items-center justify-center",children:[e.jsx(P,{size:40,className:"animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading ticket..."})]}):C?e.jsx("div",{className:"h-full flex items-center justify-center text-red-500 p-4 text-center",children:e.jsx("p",{children:C})}):o?e.jsx("iframe",{srcDoc:o,title:`Ticket for ${n.guest_name}`,className:"w-full h-full",sandbox:"allow-same-origin"}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:e.jsx("p",{children:"No ticket available"})})}):g==="qr"&&n.qr_code_url?e.jsxs("div",{className:"p-6 flex flex-col items-center justify-center",children:[e.jsx("img",{src:(E=n.qr_code_url)!=null&&E.startsWith("/")?`https://eventqr.app${n.qr_code_url}`:n.qr_code_url,alt:"QR Code",className:"max-w-[200px] border-8 border-white shadow-md rounded"}),e.jsx("p",{className:"mt-4 text-center text-gray-500 text-sm",children:"Scan this QR code at the event entrance for check-in"})]}):e.jsx("div",{className:"py-12 text-center text-gray-500",children:e.jsx("p",{children:"No ticket available for this invitation"})})}),e.jsxs("div",{className:"p-4 bg-gray-50 border-t flex flex-wrap gap-2 justify-between",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:$,disabled:x,className:"inline-flex items-center gap-1.5 px-3 py-2 bg-white border border-gray-300 text-sm text-gray-700 rounded-md hover:bg-gray-50 disabled:opacity-50",children:[x?e.jsx(P,{size:16,className:"animate-spin"}):e.jsx(de,{size:16}),e.jsx("span",{children:x?"Loading...":"Refresh"})]}),e.jsxs("button",{onClick:k,disabled:!o||x,className:"inline-flex items-center gap-1.5 px-3 py-2 bg-white border border-gray-300 text-sm text-gray-700 rounded-md hover:bg-gray-50 disabled:opacity-50",children:[e.jsx(Ie,{size:16}),e.jsx("span",{children:"Print"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.ticket_pdf_url&&e.jsxs("a",{href:n.ticket_pdf_url,download:`ticket-${n.guest_name}.pdf`,className:"inline-flex items-center gap-1.5 px-3 py-2 bg-white border border-gray-300 text-sm text-gray-700 rounded-md hover:bg-gray-50",children:[e.jsx(Te,{size:16}),e.jsx("span",{children:"PDF"})]}),n.guest_email&&i&&e.jsxs("button",{onClick:q,disabled:w,className:`inline-flex items-center gap-1.5 px-3 py-2 text-sm text-white rounded-md ${w?"bg-green-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:[e.jsx(xe,{size:16}),e.jsx("span",{children:w?"Sending...":"Email"})]}),o&&e.jsxs("a",{href:H(),download:`ticket-${n.guest_name}.html`,className:"inline-flex items-center gap-1.5 px-3 py-2 bg-indigo-600 text-sm text-white rounded-md hover:bg-indigo-700",children:[e.jsx(me,{size:16}),e.jsx("span",{children:"Download"})]})]})]})]})},lt=ie(function(){const{eventId:i}=le(),g=oe(),{token:h,isAuthenticated:w}=l.useContext(ce),[t,o]=l.useState(null),[m,x]=l.useState([]),[j,C]=l.useState(!0),[p,$]=l.useState(null),[k,q]=l.useState(typeof navigator<"u"?!navigator.onLine:!1);l.useEffect(()=>{},[w]);const[H,E]=l.useState(!1),[d,S]=l.useState({guest_name:"",guest_email:"",guest_phone:""}),[v,L]=l.useState(!1),[I,z]=l.useState(null),[U,M]=l.useState(!1),te=t!=null&&t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"";l.useEffect(()=>{const a=()=>q(!1),s=()=>q(!0);return window.addEventListener("online",a),window.addEventListener("offline",s),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",s)}},[]);const[V,W]=l.useState([]),[J,se]=l.useState(!1),[ae,F]=l.useState(!1),[X,Z]=l.useState(!1);l.useEffect(()=>{(async()=>{if(i)try{C(!0);let s=null;if(typeof window<"u"&&window.localStorage){if(s=localStorage.getItem("events"),s){const f=JSON.parse(s).find(r=>r.id.toString()===i);f&&o(f)}const c=localStorage.getItem(`invitations_${i}`);c&&x(JSON.parse(c));const u=localStorage.getItem(`attendees_${i}`);u&&W(JSON.parse(u))}if(!k){const c={"Content-Type":"application/json"};h&&(c.Authorization=`Token ${h}`);const u=fetch(`https://eventqr.app/api/events/${i}/`,{headers:c}).then(r=>{if(!r.ok)throw new Error("Failed to fetch event");return r.json()}).then(r=>{if(o(r),typeof window<"u"&&window.localStorage&&s){const N=JSON.parse(s).map(O=>O.id.toString()===i?r:O);localStorage.setItem("events",JSON.stringify(N))}}),b=fetch(`https://eventqr.app/api/invitations/?event_id=${i}`,{headers:c}).then(r=>{if(!r.ok)throw new Error("Failed to fetch invitations");return r.json()}).then(r=>{x(r),typeof window<"u"&&window.localStorage&&localStorage.setItem(`invitations_${i}`,JSON.stringify(r))}),f=fetch(`https://eventqr.app/api/attendance/?event_id=${i}`,{headers:c}).then(r=>{if(!r.ok)throw new Error("Failed to fetch attendees");return r.json()}).then(r=>{const y=r.filter(N=>N.has_attended);W(y),typeof window<"u"&&window.localStorage&&localStorage.setItem(`attendees_${i}`,JSON.stringify(y))});await Promise.all([u,b,f])}}catch(s){$("Could not load event information"),console.error(s)}finally{C(!1)}})()},[i,k]);const Q=a=>{const{name:s,value:c}=a.target;S(u=>({...u,[s]:c}))},ne=async a=>{if(a.preventDefault(),!!i)try{if(L(!0),z(null),k&&typeof window<"u"&&window.localStorage){const r={id:`temp_${Date.now()}`,guest_name:d.guest_name,guest_email:d.guest_email,guest_phone:d.guest_phone,qr_code_url:"",created_at:new Date().toISOString()},y=JSON.parse(localStorage.getItem("pending_invitations")||"[]");y.push({...r,event_id:i}),localStorage.setItem("pending_invitations",JSON.stringify(y));const N=[...m,r];x(N),localStorage.setItem(`invitations_${i}`,JSON.stringify(N)),S({guest_name:"",guest_email:"",guest_phone:""}),M(!0),setTimeout(()=>{M(!1),E(!1)},2e3);return}console.log("Creating invitation:",d);const s={"Content-Type":"application/json",Accept:"application/json"};h&&(s.Authorization=`Token ${h}`);const c=await fetch("https://eventqr.app/api/invitations/",{method:"POST",headers:s,body:JSON.stringify({...d,event:i})}),u=c.headers.get("content-type");if(u&&u.includes("text/html"))throw new Error("Server returned an HTML error page. Please check your network connection.");if(!c.ok){const r=await c.json();throw new Error(r.detail||"Failed to create invitation")}const b=await c.json(),f=[...m,b];x(f),localStorage.setItem(`invitations_${i}`,JSON.stringify(f)),S({guest_name:"",guest_email:"",guest_phone:""}),M(!0),setTimeout(()=>{M(!1),E(!1)},2e3)}catch(s){z(s instanceof Error?s.message:"An error occurred creating the invitation"),console.error(s)}finally{L(!1)}},re=()=>t?t.is_full?e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-red-100 text-red-800 rounded-full",children:"Full"}):t.max_attendees&&t.attendee_count>=t.max_attendees*.8?e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:"Almost Full"}):e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Open"}):null;return j?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(P,{size:40,className:"animate-spin mx-auto text-blue-600 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading event information..."})]})}):p&&!t?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center text-red-500 mb-2",children:[e.jsx(T,{size:24,className:"mr-2"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Error"})]}),e.jsx("p",{className:"text-gray-600",children:p})]}),e.jsx("div",{className:"bg-gray-50 p-4",children:e.jsxs("button",{onClick:()=>g(-1),className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded bg-gray-800 text-white hover:bg-gray-900 transition-colors",children:[e.jsx(R,{size:18}),e.jsx("span",{children:"Go Back"})]})})]})}):t?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white border-b sticky top-0 z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{to:"/",className:"text-gray-600 hover:text-gray-900 p-2 rounded-full hover:bg-gray-100 mr-2",children:e.jsx(R,{size:20})}),e.jsx("h1",{className:"text-xl font-bold text-gray-900 truncate",children:t.name})]}),k&&e.jsxs("div",{className:"flex items-center px-3 py-1 bg-yellow-50 text-yellow-800 rounded-full text-sm",children:[e.jsx(T,{size:16,className:"mr-1"}),e.jsx("span",{children:"Offline Mode"})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"h-48 bg-gradient-to-r from-blue-500 to-indigo-600 flex items-center justify-center",children:e.jsxs("div",{className:"text-center px-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:t.name}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mt-4",children:[re(),e.jsxs("span",{className:"px-2 py-1 text-xs font-medium bg-white/20 text-white rounded-full backdrop-blur-sm",children:[t.attendee_count," ",t.attendee_count===1?"Attendee":"Attendees"]})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 bg-blue-100 p-3 rounded-lg",children:e.jsx(he,{size:24,className:"text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Date"}),e.jsx("p",{className:"mt-1 text-base font-medium text-gray-900",children:te})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 bg-purple-100 p-3 rounded-lg",children:e.jsx(pe,{size:24,className:"text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Time"}),e.jsx("p",{className:"mt-1 text-base font-medium text-gray-900",children:t.time})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 bg-green-100 p-3 rounded-lg",children:e.jsx(ue,{size:24,className:"text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Location"}),e.jsx("p",{className:"mt-1 text-base font-medium text-gray-900",children:t.location})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 bg-orange-100 p-3 rounded-lg",children:e.jsx(B,{size:24,className:"text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Capacity"}),e.jsxs("p",{className:"mt-1 text-base font-medium text-gray-900",children:[t.attendee_count," / ",t.max_attendees||"Unlimited"]})]})]}),(t.event_type==="virtual"||t.event_type==="hybrid")&&t.virtual_link&&e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 bg-blue-100 p-3 rounded-lg",children:e.jsx(ge,{size:24,className:"text-blue-600"})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:t.event_type==="hybrid"?"Virtual Access":"Join Online"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("a",{href:t.virtual_link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx($e,{size:16}),"Join ",t.virtual_platform?t.virtual_platform.charAt(0).toUpperCase()+t.virtual_platform.slice(1):"Meeting"]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(t.virtual_link)},className:"inline-flex items-center gap-1 px-2 py-1 text-gray-500 hover:text-gray-700 transition-colors",title:"Copy link",children:e.jsx(Ee,{size:14})})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[t.virtual_platform&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Platform:"})," ",t.virtual_platform.charAt(0).toUpperCase()+t.virtual_platform.slice(1)]}),t.virtual_meeting_id&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Meeting ID:"})," ",t.virtual_meeting_id]}),t.virtual_passcode&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Passcode:"})," ",t.virtual_passcode]})]}),t.event_type==="hybrid"&&e.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Hybrid Event:"})," You can attend either in-person at ",t.location," or join virtually using the link above."]})})]})]})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"About this event"}),e.jsx("div",{className:"prose prose-blue max-w-none text-gray-700",children:t.description?e.jsx("p",{children:t.description}):e.jsx("p",{className:"text-gray-500 italic",children:"No description available."})})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t flex flex-wrap gap-3",children:[e.jsxs(A,{to:"/",className:"flex items-center gap-2 px-4 py-2 rounded-lg border border-gray-300 text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[e.jsx(R,{size:18}),e.jsx("span",{children:"All Events"})]}),e.jsxs(A,{to:`/events/${t.id}/check-in`,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 transition-colors",children:[e.jsx(fe,{size:18}),e.jsx("span",{children:"Check-in Guests"})]}),e.jsxs(A,{to:`/events/${t.id}/communication`,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-purple-600 text-white hover:bg-purple-700 transition-colors",children:[e.jsx(D,{size:18}),e.jsx("span",{children:"Communication Hub"})]}),e.jsxs("button",{onClick:()=>se(!J),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors",children:[e.jsx(_e,{size:18}),e.jsx("span",{children:J?"Hide Attendees":"View Attendees"})]}),e.jsxs("button",{onClick:()=>F(!0),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 transition-colors",children:[e.jsx(Y,{size:18}),e.jsx("span",{children:"Delete Event"})]})]}),J&&e.jsxs("div",{className:"mt-6 border-t pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Attendees List"}),e.jsx("div",{className:"flex items-center justify-center h-7 min-w-7 px-2 bg-blue-100 text-blue-800 text-sm font-medium rounded-full",children:V.length})]}),V.length===0?e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx(B,{size:40,className:"mx-auto text-gray-300 mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No attendees yet"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Attendees will appear here after check-in."})]}):e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Guest Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact Info"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check-in Time"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:V.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.invitation_details.guest_name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-500",children:[a.invitation_details.guest_email&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{size:14,className:"mr-1 text-gray-400"}),e.jsx("span",{children:a.invitation_details.guest_email})]}),a.invitation_details.guest_phone&&e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(G,{size:14,className:"mr-1 text-gray-400"}),e.jsx("span",{children:a.invitation_details.guest_phone})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.check_in_time?new Date(a.check_in_time).toLocaleString():"N/A"})]},a.id))})]})})]})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Invitations"}),e.jsx("div",{className:"flex items-center justify-center h-7 min-w-7 px-2 bg-blue-100 text-blue-800 text-sm font-medium rounded-full",children:m.length})]}),U&&e.jsxs("div",{className:"mb-4 p-3 bg-green-50 text-green-700 rounded-lg flex items-center",children:[e.jsx(K,{size:18,className:"mr-2 flex-shrink-0"}),e.jsx("span",{children:"Invitation created successfully!"})]}),H?e.jsxs("div",{className:"mb-5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"New Invitation"}),e.jsx("button",{onClick:()=>{E(!1),z(null)},className:"text-gray-400 hover:text-gray-600","aria-label":"Close form",children:e.jsx(we,{size:20})})]}),I&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 text-red-700 text-sm rounded-lg flex items-start",children:[e.jsx(T,{size:16,className:"mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:I})]}),e.jsxs("form",{onSubmit:ne,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"guest_name",className:"block text-sm font-medium text-gray-700 mb-1",children:["Guest Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"guest_name",name:"guest_name",value:d.guest_name,onChange:Q,required:!0,placeholder:"Enter guest name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 focus:outline-none text-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"guest_email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(D,{size:16,className:"text-gray-400"})}),e.jsx("input",{type:"email",id:"guest_email",name:"guest_email",value:d.guest_email,onChange:Q,placeholder:"guest@example.com",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 focus:outline-none text-gray-900"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"guest_phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(G,{size:16,className:"text-gray-400"})}),e.jsx("input",{type:"tel",id:"guest_phone",name:"guest_phone",value:d.guest_phone,onChange:Q,placeholder:"(123) 456-7890",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 focus:outline-none text-gray-900"})]})]}),e.jsx("button",{type:"submit",disabled:v,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:bg-blue-400 transition-colors",children:v?e.jsxs(e.Fragment,{children:[e.jsx(P,{size:18,className:"animate-spin"}),e.jsx("span",{children:"Creating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{size:18}),e.jsx("span",{children:"Create Invitation"})]})})]})]}):e.jsxs("button",{onClick:()=>E(!0),className:"w-full mb-5 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors",children:[e.jsx(be,{size:18}),e.jsx("span",{children:"Create Invitation"})]}),e.jsx("div",{className:"overflow-y-auto max-h-96 pr-1",children:m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(B,{size:40,className:"mx-auto text-gray-300 mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No invitations yet"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create an invitation to get started."})]}):e.jsx("ul",{className:"space-y-3",children:m.map(a=>e.jsxs("li",{className:"p-4 border border-gray-200 rounded-lg hover:border-gray-300 hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.guest_name}),e.jsxs("div",{className:"mt-2 flex flex-col gap-1 text-sm",children:[a.guest_email&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(D,{size:14,className:"mr-1.5 text-gray-400"}),e.jsx("span",{children:a.guest_email})]}),a.guest_phone&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(G,{size:14,className:"mr-1.5 text-gray-400"}),e.jsx("span",{children:a.guest_phone})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-3",children:[a.qr_code_url?e.jsxs("a",{href:`https://eventqr.app${a.qr_code_url}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 text-blue-600 text-sm hover:text-blue-800",children:[e.jsx(ye,{size:16}),e.jsx("span",{children:"View QR"})]}):e.jsxs("div",{className:"flex items-center gap-1.5 text-yellow-600 text-sm italic",children:[e.jsx(T,{size:16,className:"text-yellow-500"}),e.jsx("span",{children:"QR pending"})]}),a.id&&e.jsxs("button",{onClick:()=>{const s=document.createElement("div");s.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",s.addEventListener("click",f=>{f.target===s&&document.body.removeChild(s)});const c=document.createElement("div");c.className="bg-white rounded-lg max-w-3xl w-full shadow-lg overflow-hidden";const u=document.createElement("div");c.appendChild(u),s.appendChild(c),document.body.appendChild(s);const b=document.createElement("button");b.className="absolute top-4 right-4 p-1 rounded-full bg-white text-gray-600 hover:bg-gray-100",b.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>',b.addEventListener("click",()=>{document.body.removeChild(s)}),c.appendChild(b),Me(async()=>{const{createRoot:f}=await import("./client-37Ouhr38.js").then(r=>r.c);return{createRoot:f}},__vite__mapDeps([0,1])).then(({createRoot:f})=>{f(u).render(e.jsx(Fe,{invitation:{...a,event:{name:t.name,date:t.date,time:t.time,location:t.location,description:t.description}},onSendEmail:async()=>{if(a.guest_email)try{const y={"Content-Type":"application/json"};h&&(y.Authorization=`Token ${h}`);const N=await fetch(`https://eventqr.app/api/invitations/${a.id}/send_email/`,{method:"POST",headers:y});if(!N.ok){const O=await N.json();throw new Error(O.error||"Failed to send email")}}catch(y){throw console.error("Error sending email:",y),y}}}))})},className:"flex items-center gap-1.5 text-indigo-600 text-sm hover:text-indigo-800",children:[e.jsx(De,{size:16}),e.jsx("span",{children:"View Ticket"})]}),a.guest_email&&e.jsxs("button",{onClick:async()=>{try{const s={"Content-Type":"application/json"};h&&(s.Authorization=`Token ${h}`);const c=await fetch(`https://eventqr.app/api/invitations/${a.id}/send_email/`,{method:"POST",headers:s});if(c.ok)alert(`Ticket email sent to ${a.guest_email}`);else{const u=await c.json();throw new Error(u.error||"Failed to send email")}}catch(s){console.error("Error sending email:",s),alert(`Error sending email: ${s instanceof Error?s.message:String(s)}`)}},className:"flex items-center gap-1.5 text-green-600 text-sm hover:text-green-800",children:[e.jsx(D,{size:16}),e.jsx("span",{children:"Send Email"})]})]})]},a.id))})})]})})]})}),ae&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6 shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Delete Event"}),e.jsx("button",{onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(je,{size:24})})]}),e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"flex items-center text-red-600 mb-4",children:[e.jsx(T,{size:24,className:"mr-2"}),e.jsx("p",{className:"font-medium",children:"This action cannot be undone"})]}),e.jsx("p",{className:"text-gray-700 mb-2",children:"Are you sure you want to delete this event?"}),e.jsx("p",{className:"text-gray-600 text-sm",children:e.jsx("strong",{children:t.name})}),e.jsxs("p",{className:"text-gray-600 text-sm",children:[new Date(t.date).toLocaleDateString()," at ",t.time]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4 pt-4 border-t",children:[e.jsx("button",{onClick:()=>F(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(!(!h||!i))try{Z(!0);const a={"Content-Type":"application/json"};h&&(a.Authorization=`Token ${h}`);const s=await fetch(`https://eventqr.app/api/events/${i}/`,{method:"DELETE",headers:a});if(!s.ok)throw new Error(`Error: ${s.status}`);g("/",{replace:!0})}catch(a){console.error("Error deleting event:",a),alert("Failed to delete event. Please try again later."),F(!1),Z(!1)}},disabled:X,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-red-400 flex items-center",children:X?e.jsxs(e.Fragment,{children:[e.jsx(P,{size:18,className:"animate-spin mr-2"}),e.jsx("span",{children:"Deleting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{size:18,className:"mr-2"}),e.jsx("span",{children:"Delete Event"})]})})]})]})})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center p-6 bg-white rounded-lg shadow-md",children:[e.jsx(T,{size:40,className:"mx-auto text-gray-400 mb-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Event Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The event you're looking for doesn't exist or may have been removed."}),e.jsxs(A,{to:"/",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(R,{size:18}),e.jsx("span",{children:"Back to Events"})]})]})})});export{lt as default};
