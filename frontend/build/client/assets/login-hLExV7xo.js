import{w as f}from"./with-props-W20A4A-s.js";import{n as h,r as a,l as e,L as j}from"./chunk-K6CSEXPM--6-6YwCy.js";import{C as y}from"./circle-alert-ieDbjemo.js";import{U as b}from"./user-check-DO35yh_q.js";import{L as w}from"./lock-BTppcPD9.js";import{L as v}from"./loader-circle-DsNQqkuh.js";import{A as N}from"./AuthContext-ChgrtSKK.js";import"./createLucideIcon-DiAdES6P.js";function S({onLoginSuccess:u}){const c=h(),[t,n]=a.useState({username:"",password:""}),[o,i]=a.useState(!1),[l,x]=a.useState(null),g=m=>{const{name:s,value:r}=m.target;n(d=>({...d,[s]:r}))},p=async m=>{m.preventDefault();try{i(!0),x(null);const s=await fetch("https://eventqr.app/api/auth/login/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){const d=await s.json();throw new Error(d.error||"Login failed")}const r=await s.json();localStorage.setItem("auth_token",r.token),localStorage.setItem("user_data",JSON.stringify(r.user)),u(r.user,r.token),c("/")}catch(s){x(s instanceof Error?s.message:"Login failed")}finally{i(!1)}};return e.jsxs("div",{className:"max-w-md w-full mx-auto p-6 bg-white rounded-xl shadow-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Log In"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Sign in to your account to continue"})]}),l&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 text-red-700 rounded-lg flex items-start gap-3",children:[e.jsx(y,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:l})]}),e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(b,{size:18,className:"text-gray-400"})}),e.jsx("input",{id:"username",name:"username",type:"text",required:!0,value:t.username,onChange:g,className:"pl-10 w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500/20 focus:outline-none focus:border-indigo-500 text-gray-900",placeholder:"Your username"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(w,{size:18,className:"text-gray-400"})}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,value:t.password,onChange:g,className:"pl-10 w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500/20 focus:outline-none focus:border-indigo-500 text-gray-900",placeholder:"Your password"})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:o,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 border border-transparent rounded-lg shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors",children:o?e.jsxs(e.Fragment,{children:[e.jsx(v,{size:18,className:"animate-spin"}),e.jsx("span",{children:"Logging in..."})]}):e.jsx("span",{children:"Sign In"})})})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",e.jsx(j,{to:"/register",className:"font-medium text-indigo-600 hover:text-indigo-500",children:"Register"})]})})]})}const q=f(function(){const{login:c,isAuthenticated:t}=a.useContext(N),n=h();a.useEffect(()=>{t&&n("/",{replace:!0})},[t,n]);const o=(i,l)=>{c(i,l)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:e.jsx("h2",{className:"text-center text-3xl font-extrabold text-gray-900",children:"QR Check-in System"})}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsx(S,{onLoginSuccess:o})})]})});export{q as default};
