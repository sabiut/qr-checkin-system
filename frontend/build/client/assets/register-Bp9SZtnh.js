import{w as v}from"./with-props-W20A4A-s.js";import{n as y,t as N,r as n,l as e,L as k}from"./chunk-K6CSEXPM--6-6YwCy.js";import{C}from"./circle-alert-ieDbjemo.js";import{U as S}from"./user-CNUf_l29.js";import{M as _}from"./mail-Dab9SNH2.js";import{L as j}from"./lock-BTppcPD9.js";import{L as E}from"./loader-circle-DsNQqkuh.js";import{c as F}from"./createLucideIcon-DiAdES6P.js";import{A as P}from"./AuthContext-ChgrtSKK.js";/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],R=F("UserPlus",L);function z({onRegisterSuccess:g}){const m=y(),[o]=N(),[a,c]=n.useState({username:"",email:"",password:"",password2:"",first_name:"",last_name:""}),[u,x]=n.useState(!1),[h,f]=n.useState(null),[r,p]=n.useState({});n.useEffect(()=>{const l=o.get("email");l&&c(t=>({...t,email:l}))},[o]);const i=l=>{const{name:t,value:s}=l.target;c(d=>({...d,[t]:s})),r[t]&&p(d=>{const b={...d};return delete b[t],b})},w=async l=>{if(l.preventDefault(),f(null),p({}),a.password!==a.password2){p({password2:"Passwords don't match"});return}try{x(!0);const t=await fetch("https://eventqr.app/api/auth/register/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),s=await t.json();if(!t.ok)throw s.username||s.email||s.password?(p({...s.username&&{username:s.username.join(" ")},...s.email&&{email:s.email.join(" ")},...s.password&&{password:s.password.join(" ")}}),new Error("Please fix the errors in the form")):new Error(s.error||"Registration failed");localStorage.setItem("auth_token",s.token),localStorage.setItem("user_data",JSON.stringify(s.user)),g(s.user,s.token);const d=o.get("event");m(d?`/events/${d}/communication`:"/")}catch(t){f(t instanceof Error?t.message:"Registration failed")}finally{x(!1)}};return e.jsxs("div",{className:"max-w-lg w-full mx-auto p-8 bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl border border-gray-200",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Create an Account"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Join us to create and manage your events"})]}),h&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 text-red-700 rounded-lg flex items-start gap-3",children:[e.jsx(C,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:h})]}),e.jsxs("form",{onSubmit:w,className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username*"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(S,{size:18,className:"text-gray-400"})}),e.jsx("input",{id:"username",name:"username",type:"text",required:!0,value:a.username,onChange:i,className:`pl-10 w-full px-4 py-2.5 border ${r.username?"border-red-500":"border-gray-300"} rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500/20 focus:outline-none focus:border-indigo-500 text-gray-900`,placeholder:"Choose a username"})]}),r.username&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.username})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email*"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(_,{size:18,className:"text-gray-400"})}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:a.email,onChange:i,className:`pl-10 w-full px-4 py-2.5 border ${r.email?"border-red-500":"border-gray-300"} rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500/20 focus:outline-none focus:border-indigo-500 text-gray-900`,placeholder:"your@email.com"})]}),r.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.email})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),e.jsx("div",{className:"relative",children:e.jsx("input",{id:"first_name",name:"first_name",type:"text",value:a.first_name,onChange:i,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500/20 focus:outline-none focus:border-indigo-500 text-gray-900",placeholder:"John"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),e.jsx("div",{className:"relative",children:e.jsx("input",{id:"last_name",name:"last_name",type:"text",value:a.last_name,onChange:i,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500/20 focus:outline-none focus:border-indigo-500 text-gray-900",placeholder:"Doe"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password*"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(j,{size:18,className:"text-gray-400"})}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,value:a.password,onChange:i,className:`pl-10 w-full px-4 py-2.5 border ${r.password?"border-red-500":"border-gray-300"} rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500/20 focus:outline-none focus:border-indigo-500 text-gray-900`,placeholder:"Create a password"})]}),r.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.password})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password2",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password*"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(j,{size:18,className:"text-gray-400"})}),e.jsx("input",{id:"password2",name:"password2",type:"password",required:!0,value:a.password2,onChange:i,className:`pl-10 w-full px-4 py-2.5 border ${r.password2?"border-red-500":"border-gray-300"} rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500/20 focus:outline-none focus:border-indigo-500 text-gray-900`,placeholder:"Confirm your password"})]}),r.password2&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.password2})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",disabled:u,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 border border-transparent rounded-lg shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors",children:u?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:18,className:"animate-spin"}),e.jsx("span",{children:"Creating account..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{size:18}),e.jsx("span",{children:"Create Account"})]})})})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",e.jsx(k,{to:"/login",className:"font-medium text-indigo-600 hover:text-indigo-500",children:"Sign in"})]})})]})}const H=v(function(){const{login:m,isAuthenticated:o}=n.useContext(P),a=y();n.useEffect(()=>{o&&a("/",{replace:!0})},[o,a]);const c=(u,x)=>{m(u,x)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"QR Check-in System"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Join our community and manage your events"})]})}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsx(z,{onRegisterSuccess:c})})]})});export{H as default};
