import{w as P}from"./with-props-W20A4A-s.js";import{n as A,r as n,l as e,L as q}from"./chunk-K6CSEXPM--6-6YwCy.js";import{A as J}from"./AuthContext-ChgrtSKK.js";import{C as $}from"./chevron-left-CrOaInnJ.js";import{C as S}from"./circle-alert-ieDbjemo.js";import{C as k}from"./calendar-BN6mDgRF.js";import{C}from"./clock-9uqc5bvb.js";import{M as V}from"./map-pin-Ci7QSU5N.js";import{c as I}from"./createLucideIcon-DiAdES6P.js";import{V as U}from"./video-CxMMTtW4.js";import{U as R}from"./users-Q26tldAh.js";import{X as W}from"./x-DjrKpXYw.js";import{S as G}from"./save-Cfpy_75o.js";/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],E=I("Globe",H);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],B=I("Monitor",K),xe=P(function(){const m=A(),{token:g,isAuthenticated:f}=n.useContext(J),[v,b]=n.useState(!1),[y,j]=n.useState(null),[N,p]=n.useState(!1),[u,O]=n.useState(!1);n.useEffect(()=>{u&&!f&&m("/login",{replace:!0})},[f,m,u]);const[t,h]=n.useState({name:"",description:"",date:"",time:"",location:"",max_attendees:"",event_type:"in_person",virtual_link:"",virtual_meeting_id:"",virtual_passcode:"",virtual_platform:""}),[T,X]=n.useState("date-input-"+Date.now()),[z,Z]=n.useState("time-input-"+Date.now());n.useEffect(()=>{O(!0),typeof navigator<"u"&&p(!navigator.onLine)},[]),n.useEffect(()=>{if(!u)return;const r=()=>p(!1),s=()=>p(!0);return window.addEventListener("online",r),window.addEventListener("offline",s),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",s)}},[u]);const i=r=>{const{name:s,value:l}=r.target;h(a=>({...a,[s]:l}))},M=r=>{const{value:s}=r.target;h(l=>({...l,date:s}))},D=r=>{const{value:s}=r.target;h(l=>({...l,time:s}))},w=async r=>{const s=await r.text();try{return JSON.parse(s)}catch{if(s.trim().startsWith("<!DOCTYPE")||s.trim().startsWith("<html"))throw console.error("Received HTML instead of JSON:",s.substring(0,150)+"..."),new Error(`Server returned an HTML page instead of JSON. Status: ${r.status} ${r.statusText}`);return{error:s}}},L=async r=>{r.preventDefault();try{if(b(!0),j(null),N&&typeof window<"u"){const c=JSON.parse(localStorage.getItem("pending_events")||"[]"),d={...t,id:`temp_${Date.now()}`,attendee_count:0,is_full:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),max_attendees:t.max_attendees?parseInt(t.max_attendees):null};c.push(d),localStorage.setItem("pending_events",JSON.stringify(c));const _=JSON.parse(localStorage.getItem("events")||"[]");_.push(d),localStorage.setItem("events",JSON.stringify(_)),m("/");return}console.log("Using API URL:","https://eventqr.app");const s="https://eventqr.app/api/events/";console.log("Submitting to:",s);const l={"Content-Type":"application/json",Accept:"application/json"};g&&(l.Authorization=`Token ${g}`);const a={...t,max_attendees:t.max_attendees?parseInt(t.max_attendees):null};t.event_type==="in_person"?(delete a.virtual_link,delete a.virtual_meeting_id,delete a.virtual_passcode,delete a.virtual_platform):((!t.virtual_link||t.virtual_link.trim()==="")&&delete a.virtual_link,(!t.virtual_meeting_id||t.virtual_meeting_id.trim()==="")&&delete a.virtual_meeting_id,(!t.virtual_passcode||t.virtual_passcode.trim()==="")&&delete a.virtual_passcode,(!t.virtual_platform||t.virtual_platform.trim()==="")&&delete a.virtual_platform);const o=await fetch(s,{method:"POST",headers:l,body:JSON.stringify(a)});if(console.log("Response status:",o.status,o.statusText),(o.headers.get("content-type")||"").includes("text/html"))throw new Error(`Server returned HTML (${o.status}). Check the API URL and server configuration.`);if(!o.ok){const d=(await w(o)).detail||`Error ${o.status}: ${o.statusText}`;throw new Error(d)}const x=await w(o);if(!x||!x.id)throw new Error("Invalid response format from server");if(typeof window<"u"&&window.localStorage){const c=localStorage.getItem("events");if(c){const d=JSON.parse(c);d.push(x),localStorage.setItem("events",JSON.stringify(d))}}m(`/events/${x.id}`)}catch(s){j(s instanceof Error?s.message:"An error occurred creating the event"),console.error("Submission error:",s)}finally{b(!1)}};if(!u)return null;const F=new Date().toISOString().split("T")[0];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{to:"/",className:"p-2 -ml-2 text-gray-600 hover:text-gray-900 rounded-full hover:bg-gray-100",children:e.jsx($,{size:20})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Create New Event"})]})})}),e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-8",children:[N&&e.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 text-yellow-800 rounded-lg border border-yellow-200 flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx(S,{size:18})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Offline Mode"}),e.jsx("p",{className:"text-sm mt-1",children:"You are currently offline. The event will be saved locally and synced when you're back online."})]})]}),y&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 text-red-700 rounded-lg border border-red-200 flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx(S,{size:18})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Error"}),e.jsx("p",{className:"text-sm mt-1",children:y})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 md:p-8",children:e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"flex items-center text-sm font-medium text-gray-700 mb-1.5",children:[e.jsx("span",{children:"Event Name"}),e.jsx("span",{className:"ml-1 text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",name:"name",value:t.name,onChange:i,required:!0,placeholder:"Enter event name",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500/20 focus:outline-none focus:border-blue-500 transition-colors text-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:t.description,onChange:i,rows:4,placeholder:"Describe your event",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500/20 focus:outline-none focus:border-blue-500 transition-colors text-gray-900"}),e.jsx("p",{className:"mt-1.5 text-xs text-gray-500",children:"Provide details about your event to help attendees understand what to expect."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"date",className:"flex items-center text-sm font-medium text-gray-700 mb-1.5",children:[e.jsx(k,{size:16,className:"mr-1.5 text-gray-500"}),e.jsx("span",{children:"Date"}),e.jsx("span",{className:"ml-1 text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-gray-100 p-2.5 rounded-l-lg border border-r-0 border-gray-300",children:e.jsx(k,{size:18,className:"text-blue-500"})}),e.jsx("input",{type:"date",id:"date",name:"date",defaultValue:t.date,onChange:M,required:!0,min:F,className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-r-lg shadow-sm focus:ring-2 focus:ring-blue-500/20 focus:outline-none focus:border-blue-500 transition-colors text-gray-900",style:{appearance:"textfield",WebkitAppearance:"none"},onClick:r=>{const s=r.target;s.showPicker&&s.showPicker()}},T)]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Select a date for your event (today or later)"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"time",className:"flex items-center text-sm font-medium text-gray-700 mb-1.5",children:[e.jsx(C,{size:16,className:"mr-1.5 text-gray-500"}),e.jsx("span",{children:"Time"}),e.jsx("span",{className:"ml-1 text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-gray-100 p-2.5 rounded-l-lg border border-r-0 border-gray-300",children:e.jsx(C,{size:18,className:"text-blue-500"})}),e.jsx("input",{type:"time",id:"time",name:"time",defaultValue:t.time,onChange:D,required:!0,className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-r-lg shadow-sm focus:ring-2 focus:ring-blue-500/20 focus:outline-none focus:border-blue-500 transition-colors text-gray-900",style:{appearance:"textfield",WebkitAppearance:"none"},onClick:r=>{const s=r.target;s.showPicker&&s.showPicker()}},z)]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Choose the start time of your event"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"location",className:"flex items-center text-sm font-medium text-gray-700 mb-1.5",children:[e.jsx(V,{size:16,className:"mr-1.5 text-gray-500"}),e.jsx("span",{children:"Location"}),e.jsx("span",{className:"ml-1 text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"location",name:"location",value:t.location,onChange:i,required:!0,placeholder:"Enter venue or address",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500/20 focus:outline-none focus:border-blue-500 transition-colors text-gray-900"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"event_type",className:"flex items-center text-sm font-medium text-gray-700 mb-1.5",children:[e.jsx(B,{size:16,className:"mr-1.5 text-gray-500"}),e.jsx("span",{children:"Event Type"}),e.jsx("span",{className:"ml-1 text-red-500",children:"*"})]}),e.jsxs("select",{id:"event_type",name:"event_type",value:t.event_type,onChange:i,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500/20 focus:outline-none focus:border-blue-500 transition-colors text-gray-900 bg-white",children:[e.jsx("option",{value:"in_person",children:"In-Person"}),e.jsx("option",{value:"virtual",children:"Virtual"}),e.jsx("option",{value:"hybrid",children:"Hybrid (In-Person + Virtual)"})]}),e.jsx("p",{className:"mt-1.5 text-xs text-gray-500",children:"Choose whether this is an in-person, virtual, or hybrid event."})]}),(t.event_type==="virtual"||t.event_type==="hybrid")&&e.jsxs("div",{className:"space-y-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(U,{size:20,className:"text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"Virtual Event Details"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"virtual_platform",className:"flex items-center text-sm font-medium text-gray-700 mb-1.5",children:[e.jsx(E,{size:16,className:"mr-1.5 text-gray-500"}),e.jsx("span",{children:"Platform"}),e.jsx("span",{className:"ml-1 text-red-500",children:"*"})]}),e.jsxs("select",{id:"virtual_platform",name:"virtual_platform",value:t.virtual_platform,onChange:i,required:t.event_type==="virtual"||t.event_type==="hybrid",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500/20 focus:outline-none focus:border-blue-500 transition-colors text-gray-900 bg-white",children:[e.jsx("option",{value:"",children:"Select platform"}),e.jsx("option",{value:"zoom",children:"Zoom"}),e.jsx("option",{value:"teams",children:"Microsoft Teams"}),e.jsx("option",{value:"meet",children:"Google Meet"}),e.jsx("option",{value:"webex",children:"Cisco Webex"}),e.jsx("option",{value:"gotomeeting",children:"GoToMeeting"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"virtual_link",className:"flex items-center text-sm font-medium text-gray-700 mb-1.5",children:[e.jsx(E,{size:16,className:"mr-1.5 text-gray-500"}),e.jsx("span",{children:"Meeting Link"}),e.jsx("span",{className:"ml-1 text-red-500",children:"*"})]}),e.jsx("input",{type:"url",id:"virtual_link",name:"virtual_link",value:t.virtual_link,onChange:i,required:t.event_type==="virtual"||t.event_type==="hybrid",placeholder:"https://zoom.us/j/123456789 or https://teams.microsoft.com/...",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500/20 focus:outline-none focus:border-blue-500 transition-colors text-gray-900"}),e.jsx("p",{className:"mt-1.5 text-xs text-gray-500",children:"Full URL that attendees will use to join the virtual event."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"virtual_meeting_id",className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Meeting ID",e.jsx("span",{className:"ml-1 text-gray-400 text-xs",children:"(optional)"})]}),e.jsx("input",{type:"text",id:"virtual_meeting_id",name:"virtual_meeting_id",value:t.virtual_meeting_id,onChange:i,placeholder:"123-456-789",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500/20 focus:outline-none focus:border-blue-500 transition-colors text-gray-900"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"virtual_passcode",className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Passcode",e.jsx("span",{className:"ml-1 text-gray-400 text-xs",children:"(optional)"})]}),e.jsx("input",{type:"text",id:"virtual_passcode",name:"virtual_passcode",value:t.virtual_passcode,onChange:i,placeholder:"Meeting passcode",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500/20 focus:outline-none focus:border-blue-500 transition-colors text-gray-900"})]})]}),e.jsxs("p",{className:"text-xs text-blue-700 bg-blue-100 p-3 rounded-lg",children:[e.jsx("strong",{children:"Note:"})," Virtual event details will be included in tickets and shown to attendees. Make sure all information is accurate before creating the event."]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"max_attendees",className:"flex items-center text-sm font-medium text-gray-700 mb-1.5",children:[e.jsx(R,{size:16,className:"mr-1.5 text-gray-500"}),e.jsx("span",{children:"Maximum Attendees"}),e.jsx("span",{className:"ml-1 text-gray-400 text-xs",children:"(optional)"})]}),e.jsx("input",{type:"number",id:"max_attendees",name:"max_attendees",value:t.max_attendees,onChange:i,min:"0",placeholder:"Leave blank for unlimited",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500/20 focus:outline-none focus:border-blue-500 transition-colors text-gray-900"}),e.jsx("p",{className:"mt-1.5 text-xs text-gray-500",children:"Set a capacity limit or leave blank for unlimited attendees."})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-between gap-3 pt-4 border-t",children:[e.jsxs("button",{type:"button",onClick:()=>m(-1),className:"flex items-center justify-center gap-2 px-5 py-2.5 rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors",children:[e.jsx(W,{size:18}),e.jsx("span",{children:"Cancel"})]}),e.jsx("button",{type:"submit",disabled:v,className:"flex items-center justify-center gap-2 px-5 py-2.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-400 transition-colors font-medium",children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-white border-t-transparent animate-spin"}),e.jsx("span",{children:"Creating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{size:18}),e.jsx("span",{children:"Create Event"})]})})]})]})}),e.jsx("div",{className:"mt-6 text-center text-sm text-gray-500",children:e.jsxs("p",{children:["Fields marked with ",e.jsx("span",{className:"text-red-500",children:"*"})," are required."]})})]})]})});export{xe as default};
